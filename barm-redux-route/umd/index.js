!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("barm"),require("querystring-number")):"function"==typeof define&&define.amd?define(["exports","barm","querystring-number"],n):n((t=t||self).queryString={},t.barm,t.queryString)}(this,function(t,h,y){"use strict";var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};var v=function(){return(v=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function w(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t}function r(a){function r(t,n){var e=t+n;if(c.has(e))return c.get(e);var i=t&&t.split("/"),o=n&&n.split("/");if(!o||!i)return c.set(e,!1),!1;var r=!0;return i.forEach(function(t,n){"*"!==t&&t!==o[n]&&(r=!1)}),c.set(e,r),r}function e(t){for(var n=a.getState().paths,e=!1,i=-1,o=n.length-1;0<=o;o--){if(r(t,n[o])){i=o,e=!0;break}}return{match:r(t,n[n.length-1]),stackMatch:e,lastPage:r(t,n[n.length-2]),index:i}}function s(){if(0<window.location.hash.length){var t=window.location.hash.split("?"),n=t[0],e=t[1],i=void 0===e?"":e;return[n.replace(d,""),i]}return[window.location.pathname,window.location.search||""]}function u(n,e){i.forEach(function(t){t(n,e,a.getState())})}function l(i,o,r){i!==a.getState().paths[a.getState().paths.length-1]&&(a.update(function(t){t.paths.push(i);var n=v({},t.history[i],o);if(t.history[i]=n,"undefined"!=typeof window&&!r&&!f){var e=y.stringify(n);window.history.pushState(null,""+d+i,""===e?""+d+i:""+d+i+"?"+e)}}),u(i,o))}function p(t,e){var i=a.getState(),o="number"==typeof t?t:i.paths.length-1,n=i.paths[o-1],r=i.history[n];a.update(function(t){for(var n=0;n<t.paths.length-o;n++)e||window.history.back(),t.history[i.paths[o]]={},t.paths.pop()}),u(n,r)}var c=new Map,d="",f=!1,i=new Set;if("undefined"!=typeof window){window.addEventListener("popstate",function(){var t=a.getState().paths;if(s()[0]!==t[t.length-1]){var e=!1;if(t.forEach(function(t,n){t===s()[0]&&(e=!0)}),e)p(void 0,!0);else{var n=s(),i=n[0],o=n[1];l(i,""!==o?y.parse(o):void 0,!0)}}else u(s()[0],void 0)})}return{checkUrlMatch:e,checkUrlsStaskTop:function(t,n){return e(t).index===n.map(function(t){return e(t).index}).slice().sort(function(t,n){return n-t})[0]},init:function(t,n,e){if(void 0===e&&(e="#"),f=n||!1,d=e,a.update(function(t){t.paths=[],t.history=v({},t.history)}),"undefined"!=typeof window){var i=s(),o=i[0],r=i[1];"/"===o||o===t?l(t,y.parse(r)):(l(t),setTimeout(function(){l(o,y.parse(r))},20))}},listen:function(t){return i.add(t),function(){i.delete(t)}},pop:p,push:l,replace:function(i,o){var t=a.getState(),r=i||t.paths[t.paths.length-1];a.update(function(t){var n=v({},t.history[i],o);if(t.history[i]=n,t.paths[t.paths.length-1]=r,"undefined"!=typeof window){var e=y.stringify(n);window.history.replaceState(null,""+d+r,""===e?""+d+r:""+d+r+"?"+e)}}),u(r,o)},defineRoute:function(){return""}}}var m,g,a,b="block",S="block",C="absolute",x="auto",k="none";t.createRoute=function(t){var n,f=r(t),e=(function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}(i,n=h.Component),i.defaultProps={sync:"sync",keep:!0,animeTime:0},i);function i(){var d=null!==n&&n.apply(this,arguments)||this;return d.animeTimer=null,d.realChild=null,d.state={isRenderChild:null,realChild:null,style:{display:S,position:C,zIndex:1}},d.unListen=null,d.componentWillMount=function(){var t=d.props,n=t.delay,e=t.component;void 0!==n&&0!==n&&setTimeout(function(){d.state.realChild||e()},n)},d.componentDidMount=function(){d.unListen=f.listen(d.onHistoryUpdate)},d.componentWillUnmount=function(){d.unListen&&d.unListen(),d.realChild=null,d.animeTimer=null},d.onHistoryUpdate=function(){var t=d.props,n=t.path,e=t.delay,i=t.component,o=t.keep,r=t.leaveTime,a=d.state.isRenderChild,s=f.checkUrlMatch(n),u=s.match,l=s.stackMatch,p=s.lastPage;if(u)d.realChild||(void 0===e?(d.realChild=h.html(m=m||w(["\n              <"," />\n            "],["\n              <"," />\n            "]),i),d.onHistoryUpdate()):i().then(function(t){d.realChild=h.html(g=g||w(["\n                <"," />\n              "],["\n                <"," />\n              "]),t),d.onHistoryUpdate()})),d.setState({isRenderChild:!0,style:{pointerEvents:x,display:b,position:"relative",zIndex:3}});else{var c=o&&l;void 0!==a&&!0!==a||(p&&r&&0<r?d.setState({style:{pointerEvents:x,display:b,position:C,zIndex:b}},function(){setTimeout(function(){d.setState({isRenderChild:c,style:{pointerEvents:k,display:S,position:C,zIndex:1}})},r)}):d.setState({isRenderChild:c,style:{pointerEvents:k,display:S,position:C,zIndex:p?2:1}}))}},d.render=function(){var t=d.props,n=t.path,e=t.class,i=d.state,o=i.style;if(!i.isRenderChild)return null;var r="width: 100%; height: 100%; overflow: hidden; left: 0px; top: 0px; "+o;return h.html(a=a||w(["\n        <div about="," class="," style=",">\n          ","\n        </div>\n      "],["\n        <div about="," class="," style=",">\n          ","\n        </div>\n      "]),n,e,r,d.realChild)},d}return f.defineRoute=function(t){return h.define(t)(e),t},f},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
